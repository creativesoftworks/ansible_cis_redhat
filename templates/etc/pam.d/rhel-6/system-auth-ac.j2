#%PAM-1.0
# This file is auto-generated.
# User changes will be destroyed the next time authconfig is run.
auth        required                pam_env.so
auth        required                pam_tally2.so onerr=fail audit silent deny={{ pam.faillock.deny }} unlock_time={{ pam.faillock.unlock_time }}
auth        required                pam_faillock.so preauth audit silent deny={{ pam.faillock.deny }} unlock_time={{ pam.faillock.unlock_time }}
auth        [success=1 default=bad] pam_unix.so
auth        [default=die]           pam_faillock.so authfail audit deny={{ pam.faillock.deny }} unlock_time={{ pam.faillock.unlock_time }}
auth        sufficient              pam_faillock.so authsucc audit deny={{ pam.faillock.deny }} unlock_time={{ pam.faillock.unlock_time }}
auth        required                pam_deny.so

account     required      pam_unix.so
account     sufficient    pam_localuser.so
account     sufficient    pam_succeed_if.so uid < 500 quiet
account     required      pam_permit.so

password    required      pam_cracklib.so try_first_pass retry=3 minlen={{ pam.password_quality.passminlen }} dcredit={{ pam.password_quality.reqdigit | ternary('-1', '0') }} ucredit={{ pam.password_quality.requpper | ternary('-1', '0') }} ocredit={{ pam.password_quality.reqother | ternary('-1', '0') }} lcredit={{ pam.password_quality.reqlower | ternary('-1', '0') }} minclass={{ pam.password_quality.passminclass }} maxrepeat={{ pam.password_quality.passmaxrepeat }} maxclassrepeat={{ pam.password_quality.passmaxclassrepeat }}
password    sufficient    pam_unix.so sha512 shadow nullok try_first_pass use_authtok remember=5
password    required      pam_deny.so

session     optional      pam_keyinit.so revoke
session     required      pam_limits.so
session     [success=1 default=ignore] pam_succeed_if.so service in crond quiet use_uid
session     required      pam_unix.so
